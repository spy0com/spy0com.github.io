<!DOCTYPE html>
<html lang="">
  <head><meta name="generator" content="Hexo 3.8.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="php扫后门">













  <link rel="alternate" href="/default" title="粗鄙之语">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.10.1">



<link rel="canonical" href="http://blog.spy0.com/2019/04/04/1554371808/">



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css">




  <link rel="stylesheet" type="text/css" href="/lib/nprogress/nprogress.min.css">



<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.10.1">



  



  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>









<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":true};
</script>

    <title> php扫后门 - 粗鄙之语 </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">粗鄙之语</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            首页
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">粗鄙之语</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              首页
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          php扫后门
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-04-04
        </span>
        
        
      </div>
    </header>

    
    


    <div class="post-content">
      
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">        &lt;meta charset=&apos;gb2312&apos;&gt;</span><br><span class="line">        &lt;title&gt;PHP web shell scan&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php </span><br><span class="line">define(&quot;SELF&quot;,php_self());	</span><br><span class="line">error_reporting(E_ERROR);</span><br><span class="line">ini_set(&apos;max_execution_time&apos;,20000);</span><br><span class="line">ini_set(&apos;memory_limit&apos;,&apos;512M&apos;);</span><br><span class="line">header(&quot;content-Type: text/html; charset=gb2312&quot;);</span><br><span class="line"></span><br><span class="line">function weevelyshell($file)&#123;</span><br><span class="line">        $content=file_get_contents($file);</span><br><span class="line">        if( </span><br><span class="line">        	(</span><br><span class="line">        	preg_match(&apos;#(\$\w&#123;2,4&#125;\s?=\s?str_replace\(&quot;\w+&quot;,&quot;&quot;,&quot;[\w_]+&quot;\);\s?)+#s&apos;,$content)&amp;&amp;</span><br><span class="line">            preg_match(&apos;#(\$\w&#123;2,4&#125;\s?=\s?&quot;[\w\d\+\/\=]+&quot;;\s?)+#&apos;,$content)&amp;&amp;                             preg_match(&apos;#\$[\w]&#123;2,4&#125;\s?=\s\$[\w]&#123;2,4&#125;\(\&apos;\&apos;,\s?\$\w&#123;2,4&#125;\(\$\w&#123;2,4&#125;\(&quot;\w&#123;1,4&#125;&quot;,\s?&quot;&quot;,\s?\$\w&#123;2,4&#125;\.\$\w&#123;2,4&#125;\.\$\w&#123;2,4&#125;\.\$\w&#123;2,4&#125;\)\)\);\s+?\$\w&#123;2,4&#125;\(\)\;#&apos;,$content))</span><br><span class="line">            	||</span><br><span class="line">            	(preg_match(&apos;#\$\w+\d\s?=\s?str_replace\(\&quot;[\w\d]+\&quot;,\&quot;\&quot;,\&quot;[\w\d]+\&quot;\);#s&apos;,$content)&amp;&amp;</span><br><span class="line">                preg_match(&apos;#\$\w+\s?=\s?\$[\w\d]+\(\&apos;\&apos;,\s?\$[\w\d]+\(\$\w+\(\$\w+\(\&quot;[[:punct:]]+\&quot;,\s?\&quot;\&quot;,\s?\$\w+\.\$\w+\.\$\w+\.\$\w+\)\)\)\);\s?\$\w+\(\);#s&apos;,$content))</span><br><span class="line">                )&#123;</span><br><span class="line">                return true;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function callbackshell($file)&#123;</span><br><span class="line">	$content=file_get_contents($file);</span><br><span class="line">	if(</span><br><span class="line">		preg_match(&apos;#\$\w+\s?=\s?\$_(?:GET|POST|REQUEST|COOKIE|SERVER)\[.*?\]#is&apos;,$content)&amp;&amp;</span><br><span class="line">		preg_match(&apos;#\$\w+\s?=\s?(?:new)?\s?array\w*\s?\(.*?_(?:GET|POST|REQUEST|COOKIE|SERVER)\[.*?\].*?\)+#is&apos;,$content)&amp;&amp;</span><br><span class="line">		preg_match(&apos;#(?:array_(?:reduce|map|udiff|walk|walk_recursive|filter)|u[ak]sort)\s?\(.*?\)+?#is&apos;,$content)</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		)</span><br><span class="line">			return true;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function php_self()&#123;</span><br><span class="line">    $php_self=substr($_SERVER[&apos;PHP_SELF&apos;],strrpos($_SERVER[&apos;PHP_SELF&apos;],&apos;/&apos;)+1);</span><br><span class="line">    return $php_self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$matches = array(</span><br><span class="line">		&apos;/mb_ereg_replace\([\&apos;\*\s\,\.\&quot;]+\$_(?:GET|POST|REQUEST|COOKIE|SERVER)\[[\&apos;\&quot;].*?[\&apos;\&quot;][\]][\,\s\&apos;\&quot;]+e[\&apos;\&quot;]&apos;/is,</span><br><span class="line">		&apos;/preg_filter\([\&apos;\&quot;\|\.\*e]+.*\$_(?:GET|POST|REQUEST|COOKIE|SERVER)/is&apos;,</span><br><span class="line">		&apos;/create_function\s?\(.*assert\(/is&apos;,</span><br><span class="line">		&apos;/ini_get\(\&apos;safe_mode\&apos;\)/i&apos;,</span><br><span class="line">		&apos;/get_current_user\(.*?\)/i&apos;,</span><br><span class="line">		&apos;/@?assert\s?\(\$.*?\)/i&apos;,</span><br><span class="line">		&apos;/proc_open\s?\(.*?pipe\&apos;,\s?\&apos;w\&apos;\)/is&apos;,</span><br><span class="line">	&apos;/sTr_RepLaCe\s?\([\&apos;\&quot;].*?[\&apos;\&quot;],[\&apos;\&quot;].*?[\&apos;\&quot;]\s?,\s?\&apos;a[[:alnum:][:punct:]]+?s[[:alnum:][:punct:]]+?s[[:alnum:][:punct:]]+?e[[:alnum:][:punct:]]+?r[[:alnum:][:punct:]]+?t[[:alnum:][:punct:]]+?\)/i&apos;,</span><br><span class="line">		&apos;/preg_replace_callback\(.*?create_function\(/is&apos;,</span><br><span class="line">		&apos;/filter_var(?:_array)?\s?.*?\$_(?:GET|POST|REQUEST|COOKIE|SERVER)\[[\&apos;\&quot;][[:punct:][:alnum:]]+[\&apos;\&quot;]\][[:punct:][:alnum:][:space:]]+?assert[\&apos;\&quot;]\)/is&apos;,</span><br><span class="line">		&apos;/ob_start\([\&apos;\&quot;]+assert[\&apos;\&quot;]+\)/is&apos;,</span><br><span class="line">		&apos;/new\s?ReflectionFunction\(.*?-&gt;invoke\(/is&apos;,</span><br><span class="line">	    &apos;/PDO::FETCH_FUNC/&apos;,</span><br><span class="line">		&apos;/\$\w+.*\s?(?:=|-&gt;)\s?.*?[\&apos;\&quot;]assert[\&apos;\&quot;]\)?/i&apos;,</span><br><span class="line">		&apos;/\$\w+-&gt;(?:sqlite)?createFunction\(.*?\)/i&apos;,</span><br><span class="line">		&apos;/eval\([\&quot;\&apos;]?\\\?\$\w+\s?=\s?.*?\)/i&apos;,</span><br><span class="line">		&apos;/eval\(.*?gzinflate\(base64_decode\(/i&apos;,</span><br><span class="line">		&apos;/copy\(\$HTTP_POST_FILES\[\&apos;\w+\&apos;\]\s?\[\&apos;tmp_name\&apos;\]/i&apos;,</span><br><span class="line">		&apos;/register_(?:shutdown|tick)_function\s?\(\$\w+,\s\$_(?:GET|POST|REQUEST|COOKIE|SERVER)\[.*?\]\)/is&apos;,</span><br><span class="line">		&apos;/register_(?:shutdown|tick)_function\s?\(?[\&apos;\&quot;]assert[\&quot;\&apos;].*?\)/i&apos;,</span><br><span class="line">		&apos;/call_user_func.*?\([\&quot;|\&apos;]assert[\&quot;|\&apos;],.*\$_(?:GET|POST|REQUEST|COOKIE|SERVER)\[[\&apos;|\&quot;].*\]\)+/is&apos;,</span><br><span class="line">    	&apos;/preg_replace\(.*?e.*?\&apos;\s?,\s?.*?\w+\(.*?\)/i&apos;,</span><br><span class="line">        &apos;/function_exists\s*\(\s*[\&apos;|\&quot;](popen|exec|proc_open|system|passthru)+[\&apos;|\&quot;]\s*\)/i&apos;,</span><br><span class="line">        &apos;/(exec|shell_exec|system|passthru)+\s*\(\s*\$_(\w+)\[(.*)\]\s*\)/i&apos;,</span><br><span class="line">        &apos;/(exec|shell_exec|system|passthru)+\s*\(\$\w+\)/i&apos;,</span><br><span class="line">        &apos;/(exec|shell_exec|system|passthru)\s?\(\w+\(\&quot;http_.*\&quot;\)\)/i&apos;,</span><br><span class="line">  		&apos;/(?:john\.barker446@gmail\.com|xb5@hotmail\.com|shopen@aventgrup\.net|milw0rm\.com|www\.aventgrup\.net|mgeisler@mgeisler\.net)/i&apos;,</span><br><span class="line">    	&apos;/Php\s*?Shell/i&apos;,</span><br><span class="line">        &apos;/((udp|tcp)\:\/\/(.*)\;)+/i&apos;,</span><br><span class="line">        &apos;/preg_replace\s*\((.*)\/e(.*)\,\s*\$_(.*)\,(.*)\)/i&apos;,</span><br><span class="line">        &apos;/preg_replace\s*\((.*)\(base64_decode\(\$/i&apos;,</span><br><span class="line">        &apos;/(eval|assert|include|require|include_once|require_once)+\s*\(\s*(base64_decode|str_rot13|gz(\w+)|file_(\w+)_contents|(.*)php\:\/\/input)+/i&apos;,</span><br><span class="line">        &apos;/(eval|assert|include|require|include_once|require_once|array_map|array_walk)+\s*\(.*?\$_(?:GET|POST|REQUEST|COOKIE|SERVER|SESSION)+\[(.*)\]\s*\)/i&apos;,</span><br><span class="line">        &apos;/eval\s*\(\s*\(\s*\$\$(\w+)/i&apos;,</span><br><span class="line">    	&apos;/((?:include|require|include_once|require_once)+\s*\(?\s*[\&apos;|\&quot;]\w+\.(?!php).*[\&apos;|\&quot;])/i&apos;,</span><br><span class="line">        &apos;/\$_(\w+)(.*)(eval|assert|include|require|include_once|require_once)+\s*\(\s*\$(\w+)\s*\)/i&apos;,</span><br><span class="line">        &apos;/\(\s*\$_FILES\[(.*)\]\[(.*)\]\s*\,\s*\$_(GET|POST|REQUEST|FILES)+\[(.*)\]\[(.*)\]\s*\)/i&apos;,</span><br><span class="line">        &apos;/(fopen|fwrite|fputs|file_put_contents)+\s*\((.*)\$_(GET|POST|REQUEST|COOKIE|SERVER)+\[(.*)\](.*)\)/i&apos;,</span><br><span class="line">        &apos;/echo\s*curl_exec\s*\(\s*\$(\w+)\s*\)/i&apos;,</span><br><span class="line">        &apos;/new com\s*\(\s*[\&apos;|\&quot;]shell(.*)[\&apos;|\&quot;]\s*\)/i&apos;,</span><br><span class="line">        &apos;/\$(.*)\s*\((.*)\/e(.*)\,\s*\$_(.*)\,(.*)\)/i&apos;,</span><br><span class="line">        &apos;/\$_\=(.*)\$_/i&apos;,</span><br><span class="line">        &apos;/\$_(GET|POST|REQUEST|COOKIE|SERVER)+\[(.*)\]\(\s*\$(.*)\)/i&apos;,</span><br><span class="line">        &apos;/\$(\w+)\s*\(\s*\$_(GET|POST|REQUEST|COOKIE|SERVER)+\[(.*)\]\s*\)/i&apos;,</span><br><span class="line">        &apos;/\$(\w+)\s*\(\s*\$\&#123;(.*)\&#125;/i&apos;,</span><br><span class="line">        &apos;/\$(\w+)\s*\(\s*chr\(\d+\)/i&apos;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">function antivirus($dir,$exs,$matches) &#123;</span><br><span class="line">        if(($handle = @opendir($dir)) == NULL) return false;</span><br><span class="line">        while(false !== ($name = readdir($handle))) &#123;</span><br><span class="line">                if($name == &apos;.&apos; || $name == &apos;..&apos;) continue;</span><br><span class="line">                $path = $dir.$name;</span><br><span class="line">                if(strstr($name,SELF)) continue;</span><br><span class="line">                //$path=iconv(&quot;UTF-8&quot;,&quot;gb2312&quot;,$path);</span><br><span class="line">                if(is_dir($path)) &#123;</span><br><span class="line">                        //chmod($path,0777);/*主要针对一些0111的目录*/</span><br><span class="line">                        if(is_readable($path)) antivirus($path.&apos;/&apos;,$exs,$matches);</span><br><span class="line">                &#125; elseif(strpos($name,&apos;;&apos;) &gt; -1 || strpos($name,&apos;%00&apos;) &gt; -1 || strpos($name,&apos;/&apos;) &gt; -1) &#123;</span><br><span class="line">                        echo &apos;特征 &lt;input type=&quot;text&quot; style=&quot;width:250px;&quot; value=&quot;解析漏洞&quot;&gt; 	&apos;.$path.&apos;&lt;div&gt;&lt;/div&gt;&apos;; flush(); ob_flush();</span><br><span class="line">                &#125; </span><br><span class="line">                else &#123;</span><br><span class="line">                        if(!preg_match($exs,$name)) continue;</span><br><span class="line">                        if(filesize($path) &gt; 10000000) continue;</span><br><span class="line">                        $fp = fopen($path,&apos;r&apos;);</span><br><span class="line">                        $code = fread($fp,filesize($path));</span><br><span class="line">                        fclose($fp);</span><br><span class="line">                        if(empty($code)) continue;                     </span><br><span class="line">                        if(weevelyshell($path))&#123;</span><br><span class="line">                        echo &apos;特征 &lt;input type=&quot;text&quot; style=&quot;width:250px;&quot; value=&quot;weevely 加密shell&quot;&gt; 	&apos;.$path.&apos;&lt;div&gt;&lt;/div&gt;&apos;; flush(); ob_flush();</span><br><span class="line"></span><br><span class="line">                &#125;elseif(callbackshell($path))&#123;</span><br><span class="line">                		echo &apos;特征 &lt;input type=&quot;text&quot; style=&quot;width:250px;&quot; value=&quot;Callback shell&quot;&gt; 	&apos;.$path.&apos;&lt;div&gt;&lt;/div&gt;&apos;; flush(); ob_flush();</span><br><span class="line">                &#125;</span><br><span class="line">                        foreach($matches as $matche) &#123;</span><br><span class="line">                                $array = array();</span><br><span class="line">                                preg_match($matche,$code,$array);</span><br><span class="line">                                if(!$array) continue;</span><br><span class="line">                                if(strpos($array[0],&quot;\x24\x74\x68\x69\x73\x2d\x3e&quot;)) continue;</span><br><span class="line">                                $len = strlen($array[0]);</span><br><span class="line">                                if($len &gt; 6 &amp;&amp; $len &lt; 200) &#123;</span><br><span class="line">                                        echo &apos;特征 &lt;input type=&quot;text&quot; style=&quot;width:250px;&quot; value=&quot;&apos;.htmlspecialchars($array[0]).&apos;&quot;&gt;	&apos;.$path.&apos;&lt;div&gt;&lt;/div&gt;&apos;;</span><br><span class="line">                                        flush(); ob_flush(); break;</span><br><span class="line">                                &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        unset($code,$array);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        closedir($handle);</span><br><span class="line">        return true;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function strdir($str) &#123; return str_replace(array(&apos;\\&apos;,&apos;//&apos;,&apos;//&apos;),array(&apos;/&apos;,&apos;/&apos;,&apos;/&apos;),chop($str)); &#125;</span><br><span class="line"></span><br><span class="line">echo &apos;&lt;form method=&quot;POST&quot;&gt;&apos;;</span><br><span class="line">echo &apos;路径: &lt;input type=&quot;text&quot; name=&quot;dir&quot; value=&quot;&apos;.($_POST[&apos;dir&apos;] ? strdir($_POST[&apos;dir&apos;].&apos;/&apos;) : strdir($_SERVER[&apos;DOCUMENT_ROOT&apos;].&apos;/&apos;)).&apos;&quot; style=&quot;width:398px;&quot;&gt;&lt;div&gt;&lt;/div&gt;&apos;;</span><br><span class="line">echo &apos;后缀: &lt;input type=&quot;text&quot; name=&quot;exs&quot; value=&quot;&apos;.($_POST[&apos;exs&apos;] ? $_POST[&apos;exs&apos;] : &apos;.php|.inc|.phtml&apos;).&apos;&quot; style=&quot;width:398px;&quot;&gt;&lt;div&gt;&lt;/div&gt;&apos;;</span><br><span class="line">echo &apos;操作: &lt;input type=&quot;submit&quot; style=&quot;width:80px;&quot; value=&quot;scan&quot;&gt;&lt;div&gt;&lt;/div&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/form&gt;&apos;;</span><br><span class="line"></span><br><span class="line">if(file_exists($_POST[&apos;dir&apos;]) &amp;&amp; $_POST[&apos;exs&apos;]) &#123;</span><br><span class="line">        $dir = strdir($_POST[&apos;dir&apos;].&apos;/&apos;);</span><br><span class="line">        $exs = &apos;/(&apos;.str_replace(&apos;.&apos;,&apos;\\.&apos;,$_POST[&apos;exs&apos;]).&apos;)/i&apos;;</span><br><span class="line">        echo antivirus($dir,$exs,$matches) ? &apos;&lt;/br &gt;&lt;div&gt;&lt;/div&gt;扫描完毕!&apos; : &apos;&lt;/br &gt; &lt;div&gt;&lt;/div&gt;扫描中断&apos;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
      
    </div>

    
      
      



      
      
    

    
      <footer class="post-footer">
        
        
        
  <nav class="post-nav">
    
    
      <a class="next" href="/2019/01/10/1547119319/">
        <span class="next-text nav-default">linux怎么使用ssr</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>


      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
  </div>


        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
   
  </div>



<div class="copyright">
  <span class="power-by">
驱动&托管&设计 - Hexo Github Even
  </span>

  <span class="copyright-year">

    &copy; 
   2006
</span></div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  
  

  



    
  



  
  





  
    <script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  

  
    <script type="text/javascript" src="/lib/pjax/jquery.pjax.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/nprogress/nprogress.min.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=2.10.1"></script>

  </body>
</html>
